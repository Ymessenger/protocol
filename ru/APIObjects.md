# 4. Объекты API
## 4.1 User
| Название        | Тип значения | Описание                                                                                                   |
|-----------------|--------------|------------------------------------------------------------------------------------------------------------|
| Id              | Int64        | Идентификатор                                                                                              |
| NameFirst       | String       | Имя                                                                                                        |
| NameSecond      | String       | Фамилия                                                                                                    |
| Tag             | String       | Тэг                                                                                                        |
| About           | String       | Описание                                                                                                   |
| Photo           | String       | Изображение                                                                                                |
| NodeId          | Int64        | Идентификатор ноды                                                                                         |
| Online          | Int64        | Время последнего действия                                                                                  |
| Phones          | Phone[]      | Список телефонов                                                                                           |
| Emails          | String[]     | Список email                                                                                               |
| Privacy         | Boolean[]    | Настройки приватности для всех пользователей                                                               |
| ContactsPrivacy | Boolean[]    | Настройки приватности для контактов                                                                        |
| Contact         | Contact      | Если информацию о пользователе запрашивает другой пользователь, данное поле содержит информацию о контакте |
| Confirmed       | Boolean      | Подтвержден ли пользователь                                                                                |
| Banned          | Boolean      | Забанен ли пользователь                                                                                    |
| SyncContacts    | Boolean      | Синхронизировать ли контакты пользователя                                                                  |
### 4.1.1 EditUser
| Название        | Тип значения | Описание                                     |
|-----------------|--------------|----------------------------------------------|
| NameFirst       | String       | Имя                                          |
| NameSecond      | String       | Фамилия                                      |
| About           | String       | Описание                                     |
| Photo           | String       | Изображение                                  |
| Privacy         | Boolean[]    | Настройки приватности для всех пользователей |
| ContactsPrivacy | Boolean[]    | Настройки приватности для контактов          |
| SyncContacts    | Boolean      | Синхронизировать ли контакты пользователя    |
### 4.1.2 Настройки приватности пользователя
Настройки приватности представляют собой массив Boolean, где каждый элемент отвечает за видимость определенной информации о пользователе. Если значение TRUE, информация о пользователе видна другим пользователям.
| Номер элемента массива | Информация о пользователе   |
|----------------|-----------------------------|
| 0              |              -              |
| 1              | Tag, NameFirst и NameSecond |
| 2              | About, Photo                |
| 3              | Country                     |
| 4              | City                        |
| 5              | Birthday                    |
| 6              | Language                    |
| 14             | Online                      |
| 15             | Phone (основной телефон)    |
| 16             | Phone (резервные телефоны)  |
| 17             | Email (основной)            |
| 18             | Email (резервные)           |
| 19             | Blacklist                   |

## 4.2 Chat
| Название | Тип значения  | Описание                                                                                            |
|----------|---------------|-----------------------------------------------------------------------------------------------------|
| Id       | Int64         | Идентификатор чата                                                                                  |
| Name     | String        | Название                                                                                            |
| Tag      | String        | Тэг                                                                                                 |
| Photo    | String        | Изображение                                                                                         |
| About    | String        | Описание                                                                                            |
| NodesId  | Int64[]       | Идентификаторы нод, на которых расположен чат                                                       |
| Type     | Unsigned Int8 | Тип чата (0 - приватный, вступить можно только по приглашению; 1 - публичный, можно найти в поиске) |
| Users    | ChatUser[]    | Массив объектов с информацией о пользователях чата                                                  |
### 4.2.1 ChatUser
| Название  | Тип значения | Описание                                                                                            |
|-----------|--------------|-----------------------------------------------------------------------------------------------------|
| ChatId    | Int64        | Идентификатор чата                                                                                  |
| UserId    | Int64        | Идентификатор пользователя                                                                          |
| Deleted   | Boolean      | Удален ли пользователь из чата                                                                      |
| Banned    | Boolean      | Забанен ли пользователь в чате                                                                      |
| UserRole  | Int8         | Роль пользователя в чате: 0 - обычный пользователь, 1 - модератор, 2 - администратор, 3 - создатель |
| InviterId | Int64        | Идентификатор пользователя,  пригласившего в чат                                                    |
| Joined    | Int64        | Время, в которое пользователь был добавлен в чат                                                    |
| IsMuted   | Boolean      | Приходят ли push-уведомления пользователю                                                           |
### 4.2.2 EditChat
| Название | Тип значения  | Описание                                                                                            |
|----------|---------------|-----------------------------------------------------------------------------------------------------|
| Id       | Int64         | Идентификатор чата                                                                                  |
| Name     | String        | Название                                                                                            |
| Photo    | String        | Изображение                                                                                         |
| About    | String        | Описание                                                                                            |
## 4.3 Channel
| Название         | Тип значения  | Описание                                                    |
|------------------|---------------|-------------------------------------------------------------|
| ChannelId        | Int64         | Идентификатор канала                                        |
| ChannelName      | String        | Название                                                    |
| About            | String        | Описание                                                    |
| Tag              | String        | Тэг                                                         |
| Photo            | String        | Изображение                                                 |
| SubscribersCount | Int32         | Количество подписчиков                                      |
| Deleted          | Boolean       | Удален ли канал                                             |
| UserRole         | Int8          | Текущая роль пользователя, запросившего информацию о канале |
| NodesId          | Int64[]       | Идентификаторы нод, на которых расположен канал             |
| ChannelUsers     | ChannelUser[] | Пользователи канала                                         |
### 4.3.1 ChannelUser
| Название        | Тип значения | Описание                                                                  |
|-----------------|--------------|---------------------------------------------------------------------------|
| ChannelId       | Int64        | Идентификатор канала                                                      |
| UserId          | Int64        | Идентификатор пользователя                                                |
| ChannelUserRole | Int8         | Роль пользователя в канале: 1 - подписчик 2 - администратор 3 - создатель |
| Deleted         | Boolean      | Удален ли пользователь                                                    |
| Banned          | Boolean      | Забанен ли пользователь                                                   |
| SubscribedTime  | Int64        | Время, в которое пользователь был добавлен в канал                        |
| IsMuted         | Boolean      | Приходят ли push-уведомления пользователю                                 |
## 4.4 ConversationPreview
| Название              | Тип значения     | Описание                                          |
|-----------------------|------------------|---------------------------------------------------|
| ConversationType      | ConversationType | Тип беседы                                        |
| ConversationId        | Int64            | Идентификатор беседы                              |
| Title                 | String           | Название                                          |
| Photo                 | String           | Изображение                                       |
| PreviewText           | String           | Текст последнего сообщения                        |
| UnreadedCount         | Int32            | Количество непрочитанных сообщений                |
| LastMessageSenderId   | Int64            | Идентификатор отправителя последнего сообщения    |
| LastMessageSenderName | String           | Имя отправителя последнего сообщения              |
| LastMessageTime       | Int64            | Время отправки последнего сообщения               |
| SecondUid             | Int64            | Идентификатор второго пользователя (для диалогов) |
| Read                  | Boolean          | Все ли сообщения прочитаны                        |
| AttachmentTypes       | Int8[]           | Типы вложений в последнем сообщении               |
| LastMessageId         | UUID             | Идентификатор последнего сообщения                |
| IsMuted               | Boolean          | Приходят ли push-уведомления                      |
### 4.4.1 ConversationType enum
| Название | Значение |
|----------|----------|
| Dialog   | 1        |
| Chat     | 2        |
| Channel  | 3        |
## 4.5 Node
| Название                | Тип значения       | Описание                                                                  |
|-------------------------|--------------------|---------------------------------------------------------------------------|
| Id                      | Int64              | Идентификатор ноды                                                        |
| Name                    | String             | Название                                                                  |
| Tag                     | String             | Тэг                                                                       |
| About                   | String             | Описание                                                                  |
| Photo                   | String             | Изображение                                                               |
| Country                 | String             | Код страны в формате ISO                                                  |
| StartDay                | String             | День регистрации ноды                                                     |
| Domains                 | String[]           | Список доменов ноды                                                       |
| ClientsPort             | Int32              | Порт для подключений клиентов                                             |
| NodesPort               | Int32              | Порт для подключений других нод                                           |
| Visible                 | Boolean            | Видно ли ноду в сети                                                      |
| Storage                 | Boolean            | Хранит ли нода файлы                                                      |
| Routing                 | Boolean            | Может ли нода проксировать сообщения                                      |
| SupportEmail            | String             | Email поддержки                                                           |
| AdminEmail              | String             | Email администратора                                                      |
| NodeKey                 | NodeKey            | Объект содержащий публичные ключи ноды                                    |
| EncryptionType          | EncryptionType     | Тип шифрования                                                            |
| PermanentlyDeleting     | Boolean            | Удаляются данные пользователей полностью или делается пометка об удалении |
| RegistrationMethod      | RegistrationMethod | Тип регистрации                                                           |
| UserRegistrationAllowed | Boolean            | Разрешена ли регистрация пользователей                                    |
### 4.5.1 NodeKey
| Название      | Тип значения | Описание                                   |
|---------------|--------------|--------------------------------------------|
| KeyId         | Int64        | Идентификатор ключей                       |
| EncPublicKey  | String       | Публичный ключ шифрования в формате Base64 |
| SignPublicKey | String       | Публичный ключ подписи в формате Base64    |
| ExpiredAt     | Int64        | Время окончания срока действия ключа       |
### 4.5.2 EncryptionType enum
| Название           | Значение | Описание                                           |
|--------------------|----------|----------------------------------------------------|
| TotallyForbidden   | 0        | Шифрование полностью запрещено                     |
| NodeUsersForbidden | 1        | Шифрование запрещено для пользователей внутри ноды |
| Allowed            | 2        | Шифрование полностью разрешено                     |
### 4.5.3 RegistrationMethod enum
| Название        | Значение | Описание                                 |
|-----------------|----------|------------------------------------------|
| NothingRequired | 0        | Для регистрации ничего не требуется      |
| PhoneRequired   | 1        | Для регистрации требуется номер телефона |
| EmailRequired   | 2        | Для регистрации требуется email          |
## 4.6 Message
| Название         | Тип значения     | Описание                                                       |
|------------------|------------------|----------------------------------------------------------------|
| SendingTime      | Int64            | Время отправки сообщения                                       |
| SenderId         | Int64            | Отправитель                                                    |
| ReceiverId       | Int64            | Получатель (для диалогов)                                      |
| ConversationId   | Int64            | Идентификатор беседы                                           |
| ConversationType | ConversationType | Тип беседы                                                     |
| Read             | Boolean          | Прочитано ли сообщения                                         |
| NodesId          | Int64[]          | Идентификаторы нод, на которых хранится сообщение              |
| ReplyTo          | UUID             | Идентификатор сообщения, на которое текущее сообщение отвечает |
| Text             | String           | Текст сообщения                                                |
| Attachments      | Attachment[]     | Список вложений                                                |
| GlobalId         | UUID             | Идентификатор сообщения                                        |
| UpdatedAt        | Int64            | Время редактирования сообщения                                 |
| Lifetime         | Int64            | Время жизни сообщения                                          |
### 4.6.1 Attachment
| Название | Тип значения      | Описание                        |
|----------|-------------------|---------------------------------|
| Type     | AttachmentType    | Тип вложения                    |
| Hash     | String            | SHA256-хэш содержимого вложения |
| Payload  | String или Object | Содержимое вложения             |
### 4.6.2 AttachmentType enum
| Название          | Значение | Описание                                                                                                                    |
|-------------------|----------|-----------------------------------------------------------------------------------------------------------------------------|
| Audio             | 0        | Аудио-файл. Payload содержит идентификатор файла                                                                            |
| File              | 1        | Обычный файл. Payload содержит идентификатор файла                                                                          |
| Picture           | 2        | Изображение. Payload содержит идентификатор файла                                                                           |
| Video             | 3        | Видео-файл. Payload содержит идентификатор файла                                                                            |
| EncryptedMessage  | 4        | Зашифрованное сообщение. Payload содержит объект EncryptedMessage                                                           |
| ForwardedMessages | 5        | Пересланные сообщения. Для отправки Payload должен содержать объект ForwardedMessagesInfo, при получении содержит Message[] |
| KeyMessage        | 6        | Сообщение с зашифрованным  симметричным ключом. Payload содержит объект KeyMessage                                          |
| Poll              | 7        | Опрос. Payload содержит объект Poll                                                                                         |
| VoiceMessage      | 8        | Голосовое сообщение. Payload содержит идентификатор файла                                                                   |
| VideoMessage      | 9        | Видеосообщение. Payload содержит идентификатор файла                                                                        |
| SystemMessage     | 10       | Системное сообщение. Payload содержит объект SystemMessageInfo                                                              |
### 4.6.3 EncryptedMessage
| Название      | Тип значения | Описание                                                       |
|---------------|--------------|----------------------------------------------------------------|
| KeyId         | Int64        | Идентификатор симметричного ключа шифрования                   |
| SignKeyId     | Int64        | Идентификатор асимметричного ключа подписи                     |
| SaveFlag      | Boolean      | Сохранять ли сообщение на сервере                              |
| Lifetime      | Int64        | Время жизни сообщения в секундах                                        |
| EncryptedData | String       | Зашифрованный симметричным ключом контент сообщения. Массив Int8[] в формате Base64 |
### 4.6.4 KeyMessage
| Название      | Тип значения | Описание                                          |
|---------------|--------------|---------------------------------------------------|
| KeyId         | Int64        | Идентификатор aсимметричного ключа шифрования собеседника. Этим ключом шифруется симметричный ключ     |
| SignKeyId     | Int64        | Идентификатор своего асимметричного ключа подписи. Приватным асимметричным ключом подписываются зашифрованные данные        |
| EncryptedData | String       | Зашифрованный симметричный ключ. Массив Int8[] в формате Base64 |
### 4.6.5 ForwardedMessagesInfo
| Название         | Тип значения     | Описание                                            |
|------------------|------------------|-----------------------------------------------------|
| MessagesGlobalId | UUID[]           | Идентификаторы пересылаемых сообщений               |
| ConversationId   | Int64            | Идентификатор беседы, откуда пересылаются сообщения |
| ConversationType | ConversationType | Тип беседы, откуда пересылаются сообщения           |
### 4.6.6 SystemMessageInfo
| Название            | Тип значения | Описание                           |
|---------------------|--------------|------------------------------------|
| SystemMessageId     | String       | Идентификатор системного сообщения |
| Description         | String       | Описание системного сообщения      |
| UserId              | Int64        | Идентификатор пользователя         |
| OldConversationName | String       | Старое имя чата/канала             |
| NewConversationName | String       | Новое имя чата/канала              |
### 4.6.7 Идентификаторы системных сообщений
| Название    | Значение    | Описание                       |
|-------------|-------------|--------------------------------|
| UserRemoved | UserRemoved | Пользователь удален из беседы  |
| UserAdded   | UserAdded   | Пользователь добавлен в беседу |
| UserBanned  | UserBanned  | Пользователь забанен в беседе  |
| NameChanged | NameChanged | Имя беседы было изменено       |
| Screenshot  | Screenshot  | Был сделан скриншот            |
## 4.8 Token
| Название                   | Тип значения | Описание                                                        |
|----------------------------|--------------|-----------------------------------------------------------------|
| Id                         | Int64        | Идентификатор токена                                            |
| UserId                     | Int64        | Идентификатор пользователя                                      |
| AccessToken                | String       | Access-токен, нужен для авторизации                             |
| RefreshToken               | String       | Refresh-токен, нужен для обновления пары токенов                |
| DeviceTokenId              | String       | Firebase-идентификатор устройства для отправки push-уведомлений |
| AccessTokenExpirationTime  | Int64        | Время истечения Access-токена                                   |
| RefreshTokenExpirationTime | Int64        | Время истечения Refresh-токена                                  |
| OSName                     | String       | Имя операционной системы                                        |
| DeviceName                 | String       | Имя устройства                                                  |
| AppName                    | String       | Имя приложения                                                  |
## 4.9 Poll
| Название          | Тип значения     | Описание                                         |
|-------------------|------------------|--------------------------------------------------|
| PollId            | UUID             | Идентификатор опроса                             |
| Title             | String           | Название опроса                                  |
| ConversationId    | Int64            | Идентификатор чата/канала                        |
| ConversationType  | ConversationType | Тип беседы                                       |
| MultipleSelection | Boolean          | Доступен ли множественный выбор вариантов ответа |
| ResulsVisibility  | Boolean          | Видны ли результаты опроса другим пользователям  |
| Voted             | Boolean          | Проголосовал ли в опросе текущий пользователь    |
| SignRequired      | Boolean          | Требуется ли подпись для голосования в опросе    |
| PollOptions       | PollOption[]     | Список объектов, содержащих варианты ответов     |
### 4.9.1 PollOption
| Название        | Тип значения | Описание                                 |
|-----------------|--------------|------------------------------------------|
| OptionId        | Int8         | Идентификатор варианта ответа            |
| Description     | String       | Описание                                 |
| VotedUsersCount | Int64        | Количество проголосовавших пользователей |
| Voted           | Boolean      | Проголосовал ли текущий пользователь     |
### 4.9.2 PollVote
| Название | Тип значения | Описание                      |
|----------|--------------|-------------------------------|
| OptionId | Int8         | Идентификатор варианта ответа |
| Sign     | Sign         | Объект, содержащий подпись    |
Формат подписываемых данных:
``` 
{"PollId":"Идентификатор опроса","UserId":идентификатор пользователя,"OptionId":идентификатор варианта ответа}
``` 
Поля должны идти именно в таком порядке.
## 4.10 Group
| Название        | Тип значения | Описание                                          |
|-----------------|--------------|---------------------------------------------------|
| GroupId         | UUID         | Идентификатор группы                              |
| Title           | String       | Название группы                                   |
| PrivacySettings | Boolean[]    | Настройки приватности для пользователей группы    |
| UsersId         | Int64[]      | Идентификатор пользователей, находящихся в группе |
## 4.11 Contact
| Название      | Тип значения | Описание                                                                   |
|---------------|--------------|----------------------------------------------------------------------------|
| ContactId     | UUID         | Идентификатор контакта                                                     |
| ContactUserId | Int64        | Идентификатор пользователя                                                 |
| Name          | String       | Имя контакта                                                               |
| ContactUser   | User         | Объект, содержащий информацию о пользователе                               |
| GroupsId      | UUID[]       | Список идентификаторов групп контактов, в которых данный контакт находится |
## 4.12 Favorites
| Название     | Тип значения | Описание                                 |
|--------------|--------------|------------------------------------------|
| ChatId       | Int64        | Идентификатор чата                       |
| ChannelId    | Int64        | Идентификатор канала                     |
| ContactId    | UUID         | Идентификатор контакта                   |
| SerialNumber | Int16        | Порядковый номер в списке избранного     |
| Chat         | Chat         | Объект, содержащий информацию о чате     |
| Channel      | Channel      | Объект, содержащий информацию о канале   |
| Contact      | Contact      | Объект, содержащий информацию о контакте |
Объект Favorites содержит информацию либо о чате, либо о канале, либо о контакте.
## 4.13 QRCode для авторизации
| Название     | Тип значения | Описание                                 |
|--------------|--------------|------------------------------------------|
| ChatId       | Int64        | Идентификатор чата                       |
| ChannelId    | Int64        | Идентификатор канала                     |
| ContactId    | UUID         | Идентификатор контакта                   |
| SerialNumber | Int16        | Порядковый номер в списке избранного     |
| Chat         | Chat         | Объект, содержащий информацию о чате     |
| Channel      | Channel      | Объект, содержащий информацию о канале   |
| Contact      | Contact      | Объект, содержащий информацию о контакте |
## 4.14 Session
| Название         | Тип значения | Описание                   |
|------------------|--------------|----------------------------|
| TokenId          | Int64        | Идентификатор токена       |
| DeviceName       | String       | Имя устройства             |
| AppName          | String       | Имя приложения             |
| OSName           | String       | Имя операционной системы   |
| IP               | String       | IP-адрес                   |
| IsCurrent        | Boolean      | Является ли сессия текущей |
| LastActivityTime | Int64        | Время последней активности |
## 4.15 FileInfo
| Название      | Тип значения  | Описание                                                                      |
|---------------|---------------|-------------------------------------------------------------------------------|
| FileId        | String        | Идентификатор файла                                                           |
| Filename      | String        | Имя файла                                                                     |
| Hash          | String        | Хэш файла                                                                     |
| Uploaded      | Int64         | Время загрузки файла                                                          |
| UploaderId    | Int64         | Идентификатор пользователя, загрузившего файл                                 |
| NodeId        | Int64         | Идентификатор ноды, на которую файл был загружен                              |
| Size          | Int64         | Размер файла в байтах                                                         |
| ImageMetadata | ImageMetadata | Объект, содержащий информацию об изображении, если файл является изображением |
### 4.15.1 ImageMetadata
| Название | Тип значения | Описание           |
|----------|--------------|--------------------|
| Height   | Int32        | Высота             |
| Width    | Int32        | Ширина             |
| Format   | String       | Формат изображения |
## 4.16 Key
| Название       | Тип значения | Описание                                                                                            |
|----------------|--------------|-----------------------------------------------------------------------------------------------------|
| KeyId          | Int64        | Идентификатор ключа                                                                                 |
| Data           | String       | Ключ. Массив Int8[] в формате Base64                                                                |
| Lifetime       | Int64        | Время жизни ключа                                                                                   |
| GenerationTime | Int64        | Время генерации ключа                                                                               |
| Version        | Int8         | Версия ключа                                                                                        |
| UserId         | Int64        | Идентификатор пользователя                                                                          |
| ChatId         | Int64        | Идентификатор чата                                                                                  |
| NodeId         | Int64        | Идентификатор ноды                                                                                  |
| Type           | Int8         | Тип ключа: 0 - асимметричный ключ подписи; 1 - асимметричный ключ шифрования; 2 - симметричный ключ |
## 4.17 Phone
| Название         | Тип значения | Описание                                     |
|------------------|--------------|----------------------------------------------|
| CountryCode      | Int16        | Код страны                                   |
| SubscriberNumber | Int64        | Номер абонента                               |
| FullNumber       | String       | Строковое представление номера: +XZZZYYYYYYY |
## 4.18 Sign
| Название | Тип значения | Описание                                      |
|----------|--------------|-----------------------------------------------|
| KeyId    | Int64        | Идентификатор ключа подписи                   |
| Data     | String       | Данные подписи (массив Int8) в формате Base64 |

## 4.19 AsymmetricKey

| Название | Тип значения | Описание |
|-|-|-|
| KeyId | Int64 | Идентификатор ключей |
| UserId | Int64 | Идентификатор пользователя |
| PublicKey | String | Публичный ключ в формате Base64 |
| PrivateKey | String | Приватный ключ в формате Base64 |
| Lifetime | Int64 | Время жизни ключа |
| GenerationTime | Int64 | Время генерации ключа |
| IsSign | Boolean | Является ли ключ ключом для подписи |